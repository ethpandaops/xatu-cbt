syntax = "proto3";

package cbt;

import "common.proto";
import "google/protobuf/wrappers.proto";

option go_package = "github.com/ethpandaops/xatu-cbt/pkg/proto/clickhouse";
// Block details for the finalized chain, this includes before and after the merge.

message DimBlockCanonical {
  // Timestamp when the record was last updated
  uint32 updated_date_time = 11;
  // The execution block number
  uint32 block_number = 12;
  // The hash of the execution block
  string execution_block_hash = 13;
  // The execution block date and time
  uint32 block_date_time = 14;
  // The slot number of the beacon block
  google.protobuf.UInt32Value slot = 15;
  // The wall clock time when the slot started
  google.protobuf.UInt32Value slot_start_date_time = 16;
  // The epoch number of the beacon block
  google.protobuf.UInt32Value epoch = 17;
  // The wall clock time when the epoch started
  google.protobuf.UInt32Value epoch_start_date_time = 18;
  // The version of the beacon block
  google.protobuf.StringValue beacon_block_version = 19;
  // The root hash of the beacon block
  google.protobuf.StringValue beacon_block_root = 20;
  // The root hash of the parent beacon block
  google.protobuf.StringValue beacon_parent_root = 21;
  // The root hash of the beacon state at this block
  google.protobuf.StringValue beacon_state_root = 22;
}

// Request for listing dim_block_canonical records
message ListDimBlockCanonicalRequest {
  // Filter by block_number - The execution block number (PRIMARY KEY - required)
  UInt32Filter block_number = 1;

  // Filter by updated_date_time - Timestamp when the record was last updated (optional)
  UInt32Filter updated_date_time = 2;
  // Filter by execution_block_hash - The hash of the execution block (optional)
  StringFilter execution_block_hash = 3;
  // Filter by block_date_time - The execution block date and time (optional)
  UInt32Filter block_date_time = 4;
  // Filter by slot - The slot number of the beacon block (optional)
  NullableUInt32Filter slot = 5;
  // Filter by slot_start_date_time - The wall clock time when the slot started (optional)
  NullableUInt32Filter slot_start_date_time = 6;
  // Filter by epoch - The epoch number of the beacon block (optional)
  NullableUInt32Filter epoch = 7;
  // Filter by epoch_start_date_time - The wall clock time when the epoch started (optional)
  NullableUInt32Filter epoch_start_date_time = 8;
  // Filter by beacon_block_version - The version of the beacon block (optional)
  NullableStringFilter beacon_block_version = 9;
  // Filter by beacon_block_root - The root hash of the beacon block (optional)
  NullableStringFilter beacon_block_root = 10;
  // Filter by beacon_parent_root - The root hash of the parent beacon block (optional)
  NullableStringFilter beacon_parent_root = 11;
  // Filter by beacon_state_root - The root hash of the beacon state at this block (optional)
  NullableStringFilter beacon_state_root = 12;

  // The maximum number of dim_block_canonical to return.
  // If unspecified, at most 100 items will be returned.
  // The maximum value is 10000; values above 10000 will be coerced to 10000.
  int32 page_size = 13;
  // A page token, received from a previous `ListDimBlockCanonical` call.
  // Provide this to retrieve the subsequent page.
  string page_token = 14;
  // The order of results. Format: comma-separated list of fields.
  // Example: "foo,bar" or "foo desc,bar" for descending order on foo.
  // If unspecified, results will be returned in the default order.
  string order_by = 15;
}

// Response for listing dim_block_canonical records
message ListDimBlockCanonicalResponse {
  // The list of dim_block_canonical.
  repeated DimBlockCanonical dim_block_canonical = 1;
  // A token, which can be sent as `page_token` to retrieve the next page.
  // If this field is omitted, there are no subsequent pages.
  string next_page_token = 2;
}

// Request for getting a single dim_block_canonical record by primary key
message GetDimBlockCanonicalRequest {
  // The execution block number
  uint32 block_number = 1; // Primary key (required)
}

// Response for getting a single dim_block_canonical record
message GetDimBlockCanonicalResponse {
  DimBlockCanonical item = 1;
}

// Query dim_block_canonical data
service DimBlockCanonicalService {
  // List records | Retrieve paginated results with optional filtering
  rpc List(ListDimBlockCanonicalRequest) returns (ListDimBlockCanonicalResponse);
  // Get record | Retrieve a single record by primary key
  rpc Get(GetDimBlockCanonicalRequest) returns (GetDimBlockCanonicalResponse);
}
