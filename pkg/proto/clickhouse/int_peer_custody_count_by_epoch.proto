syntax = "proto3";

package cbt;

import "common.proto";
import "google/protobuf/wrappers.proto";

option go_package = "github.com/ethpandaops/xatu-cbt/pkg/proto/clickhouse";
// Peer custody count per epoch with full peer metadata for dimension analysis

message IntPeerCustodyCountByEpoch {
  // Timestamp when the record was last updated
  uint32 updated_date_time = 11;
  // Epoch number
  uint64 epoch = 12;
  // Start date time of the epoch
  uint32 epoch_start_date_time = 13;
  // Number of custody groups the peer is custodying (1-128)
  uint32 custody_group_count = 14;
  // Unique key associated with the identifier of the peer
  int64 peer_id_unique_key = 15;
  // Implementation of the peer (e.g., Lighthouse, Prysm)
  string peer_agent_implementation = 16;
  // Full version string of the peer
  string peer_agent_version = 17;
  // Major version of the peer
  string peer_agent_version_major = 18;
  // Minor version of the peer
  string peer_agent_version_minor = 19;
  // Patch version of the peer
  string peer_agent_version_patch = 20;
  // Platform of the peer (e.g., linux-x86_64)
  string peer_agent_platform = 21;
  // IP address of the peer
  google.protobuf.StringValue peer_ip = 22;
  // Port of the peer
  google.protobuf.UInt32Value peer_port = 23;
  // City of the peer
  string peer_geo_city = 24;
  // Country of the peer
  string peer_geo_country = 25;
  // Country code of the peer
  string peer_geo_country_code = 26;
  // Continent code of the peer
  string peer_geo_continent_code = 27;
  // Longitude of the peer
  google.protobuf.DoubleValue peer_geo_longitude = 28;
  // Latitude of the peer
  google.protobuf.DoubleValue peer_geo_latitude = 29;
  // Autonomous system number (ASN) of the peer
  google.protobuf.UInt32Value peer_geo_autonomous_system_number = 30;
  // Autonomous system organization (ISP) of the peer
  google.protobuf.StringValue peer_geo_autonomous_system_organization = 31;
}

// Request for listing int_peer_custody_count_by_epoch records
message ListIntPeerCustodyCountByEpochRequest {
  // Filter by epoch - Epoch number (PRIMARY KEY - required)
  UInt64Filter epoch = 1;

  // Filter by custody_group_count - Number of custody groups the peer is custodying (1-128) (ORDER BY column 2 - optional)
  UInt32Filter custody_group_count = 2;

  // Filter by peer_id_unique_key - Unique key associated with the identifier of the peer (ORDER BY column 3 - optional)
  Int64Filter peer_id_unique_key = 3;

  // Filter by updated_date_time - Timestamp when the record was last updated (optional)
  UInt32Filter updated_date_time = 4;
  // Filter by epoch_start_date_time - Start date time of the epoch (optional)
  UInt32Filter epoch_start_date_time = 5;
  // Filter by peer_agent_implementation - Implementation of the peer (e.g., Lighthouse, Prysm) (optional)
  StringFilter peer_agent_implementation = 6;
  // Filter by peer_agent_version - Full version string of the peer (optional)
  StringFilter peer_agent_version = 7;
  // Filter by peer_agent_version_major - Major version of the peer (optional)
  StringFilter peer_agent_version_major = 8;
  // Filter by peer_agent_version_minor - Minor version of the peer (optional)
  StringFilter peer_agent_version_minor = 9;
  // Filter by peer_agent_version_patch - Patch version of the peer (optional)
  StringFilter peer_agent_version_patch = 10;
  // Filter by peer_agent_platform - Platform of the peer (e.g., linux-x86_64) (optional)
  StringFilter peer_agent_platform = 11;
  // Filter by peer_ip - IP address of the peer (optional)
  NullableStringFilter peer_ip = 12;
  // Filter by peer_port - Port of the peer (optional)
  NullableUInt32Filter peer_port = 13;
  // Filter by peer_geo_city - City of the peer (optional)
  StringFilter peer_geo_city = 14;
  // Filter by peer_geo_country - Country of the peer (optional)
  StringFilter peer_geo_country = 15;
  // Filter by peer_geo_country_code - Country code of the peer (optional)
  StringFilter peer_geo_country_code = 16;
  // Filter by peer_geo_continent_code - Continent code of the peer (optional)
  StringFilter peer_geo_continent_code = 17;
  // Filter by peer_geo_longitude - Longitude of the peer (optional)
  google.protobuf.DoubleValue peer_geo_longitude = 18;
  // Filter by peer_geo_latitude - Latitude of the peer (optional)
  google.protobuf.DoubleValue peer_geo_latitude = 19;
  // Filter by peer_geo_autonomous_system_number - Autonomous system number (ASN) of the peer (optional)
  NullableUInt32Filter peer_geo_autonomous_system_number = 20;
  // Filter by peer_geo_autonomous_system_organization - Autonomous system organization (ISP) of the peer (optional)
  NullableStringFilter peer_geo_autonomous_system_organization = 21;

  // The maximum number of int_peer_custody_count_by_epoch to return.
  // If unspecified, at most 100 items will be returned.
  // The maximum value is 10000; values above 10000 will be coerced to 10000.
  int32 page_size = 22;
  // A page token, received from a previous `ListIntPeerCustodyCountByEpoch` call.
  // Provide this to retrieve the subsequent page.
  string page_token = 23;
  // The order of results. Format: comma-separated list of fields.
  // Example: "foo,bar" or "foo desc,bar" for descending order on foo.
  // If unspecified, results will be returned in the default order.
  string order_by = 24;
}

// Response for listing int_peer_custody_count_by_epoch records
message ListIntPeerCustodyCountByEpochResponse {
  // The list of int_peer_custody_count_by_epoch.
  repeated IntPeerCustodyCountByEpoch int_peer_custody_count_by_epoch = 1;
  // A token, which can be sent as `page_token` to retrieve the next page.
  // If this field is omitted, there are no subsequent pages.
  string next_page_token = 2;
}

// Request for getting a single int_peer_custody_count_by_epoch record by primary key
message GetIntPeerCustodyCountByEpochRequest {
  // Epoch number
  uint64 epoch = 1; // Primary key (required)
}

// Response for getting a single int_peer_custody_count_by_epoch record
message GetIntPeerCustodyCountByEpochResponse {
  IntPeerCustodyCountByEpoch item = 1;
}

// Query int_peer_custody_count_by_epoch data
service IntPeerCustodyCountByEpochService {
  // List records | Retrieve paginated results with optional filtering
  rpc List(ListIntPeerCustodyCountByEpochRequest) returns (ListIntPeerCustodyCountByEpochResponse);
  // Get record | Retrieve a single record by primary key
  rpc Get(GetIntPeerCustodyCountByEpochRequest) returns (GetIntPeerCustodyCountByEpochResponse);
}
