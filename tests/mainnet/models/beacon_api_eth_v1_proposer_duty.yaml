model: beacon_api_eth_v1_proposer_duty
network: mainnet
external_data:
    beacon_api_eth_v1_proposer_duty:
        url: https://data.ethpandaops.io/xatu-cbt/tests/mainnet/beacon_api_eth_v1_proposer_duty_beacon_api_eth_v1_proposer_duty.parquet
        network_column: meta_network_name
assertions:
    - name: total count
      sql: |
        SELECT
          COUNT(*) AS count
        FROM
          cluster('{remote_cluster}', default.beacon_api_eth_v1_proposer_duty) FINAL
      expected:
        count: 42
