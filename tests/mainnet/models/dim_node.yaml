model: dim_node
network: mainnet
external_data:
    ethseer_validator_entity:
        url: https://data.ethpandaops.io/xatu-cbt/tests/mainnet/ethseer_validator_entity.parquet
        network_column: meta_network_name
assertions:
  - name: Expected size
    sql: |
      SELECT COUNT(*) AS row_count FROM dim_node FINAL
    assertions:
      - type: greater_than
        column: row_count
        value: 999
  - name: Has been scheduled at least once
    sql: |
      SELECT COUNT(*) AS count FROM admin_cbt_scheduled FINAL
      WHERE table = 'dim_node'
    assertions:
      - type: equals
        column: count
        value: 1
