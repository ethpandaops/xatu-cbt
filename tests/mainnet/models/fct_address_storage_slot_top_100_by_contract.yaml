model: fct_address_storage_slot_top_100_by_contract
network: mainnet
external_data:
    canonical_execution_storage_diffs:
        url: https://data.ethpandaops.io/xatu-cbt/tests/mainnet/fct_address_storage_slot_top_100_by_contract_canonical_execution_storage_diffs.parquet
        network_column: meta_network_name
    canonical_execution_storage_reads:
        url: https://data.ethpandaops.io/xatu-cbt/tests/mainnet/fct_address_storage_slot_top_100_by_contract_canonical_execution_storage_reads.parquet
        network_column: meta_network_name
assertions:
  - name: Expected bounds and size
    sql: |
      SELECT
        COUNT(*) AS count,
        argMin(contract_address, rank) AS top_contract_address,
        argMin(total_storage_slots, rank) AS top_total_storage_slots,
        argMax(contract_address, rank) AS bottom_contract_address,
        argMax(total_storage_slots, rank) AS bottom_total_storage_slots
      FROM
        fct_address_storage_slot_top_100_by_contract FINAL
    expected:
      bottom_contract_address: 0x1715a3e4a142d8b698131108995174f37aeba10d
      bottom_total_storage_slots: 42
      count: 100
      top_contract_address: 0xdac17f958d2ee523a2206206994597c13d831ec7
      top_total_storage_slots: 7503
