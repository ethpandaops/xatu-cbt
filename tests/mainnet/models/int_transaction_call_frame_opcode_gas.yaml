model: int_transaction_call_frame_opcode_gas
network: mainnet
external_data:
    canonical_execution_transaction_structlog_agg:
        url: https://data.ethpandaops.io/xatu-cbt/tests/mainnet/int_transaction_call_frame_opcode_gas_canonical_execution_transaction_structlog_agg.parquet
        network_column: meta_network_name
assertions:
    - name: Row count should be greater than zero
      sql: |
        SELECT COUNT(*) AS row_count FROM int_transaction_call_frame_opcode_gas FINAL
      assertions:
        - type: greater_than
          column: row_count
          value: 0
    - name: No null or empty opcode values
      sql: |
        SELECT COUNT(*) AS bad_rows FROM int_transaction_call_frame_opcode_gas FINAL
        WHERE opcode = '' OR opcode IS NULL
      assertions:
        - type: equals
          column: bad_rows
          value: 0
    - name: No non-positive opcode count values
      sql: |
        SELECT COUNT(*) AS bad_rows FROM int_transaction_call_frame_opcode_gas FINAL
        WHERE count <= 0
      assertions:
        - type: equals
          column: bad_rows
          value: 0
    - name: No negative gas values
      sql: |
        SELECT COUNT(*) AS bad_rows FROM int_transaction_call_frame_opcode_gas FINAL
        WHERE gas < 0
      assertions:
        - type: equals
          column: bad_rows
          value: 0
    - name: No negative gas_cumulative values
      sql: |
        SELECT COUNT(*) AS bad_rows FROM int_transaction_call_frame_opcode_gas FINAL
        WHERE gas_cumulative < 0
      assertions:
        - type: equals
          column: bad_rows
          value: 0
    - name: gas_cumulative should be greater than or equal to gas
      sql: |
        SELECT COUNT(*) AS bad_rows FROM int_transaction_call_frame_opcode_gas FINAL
        WHERE gas_cumulative < gas
      assertions:
        - type: equals
          column: bad_rows
          value: 0
    - name: No negative error_count values
      sql: |
        SELECT COUNT(*) AS bad_rows FROM int_transaction_call_frame_opcode_gas FINAL
        WHERE error_count < 0
      assertions:
        - type: equals
          column: bad_rows
          value: 0
    - name: No negative call_frame_id values
      sql: |
        SELECT COUNT(*) AS bad_rows FROM int_transaction_call_frame_opcode_gas FINAL
        WHERE call_frame_id < 0
      assertions:
        - type: equals
          column: bad_rows
          value: 0
    - name: No negative memory_expansion_gas values
      sql: |
        SELECT COUNT(*) AS bad_rows FROM int_transaction_call_frame_opcode_gas FINAL
        WHERE memory_expansion_gas < 0
      assertions:
        - type: equals
          column: bad_rows
          value: 0
    - name: No negative cold_access_count values
      sql: |
        SELECT COUNT(*) AS bad_rows FROM int_transaction_call_frame_opcode_gas FINAL
        WHERE cold_access_count < 0
      assertions:
        - type: equals
          column: bad_rows
          value: 0
