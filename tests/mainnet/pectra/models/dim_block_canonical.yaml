model: dim_block_canonical
network: mainnet
spec: pectra
external_data:
    canonical_execution_block:
        url: https://data.ethpandaops.io/xatu-cbt/pectra/canonical_execution_block.parquet
        network_column: meta_network_name
    canonical_beacon_block:
        url: https://data.ethpandaops.io/xatu-cbt/pectra/canonical_beacon_block.parquet
        network_column: meta_network_name
assertions:
    - name: Expected size
      sql: |
        SELECT
          COUNT(*) AS count
        FROM
          dim_block_canonical FINAL
      expected:
        count: 20
    - name: Has been scheduled at least once
      sql: |
        SELECT
          COUNT(*) AS count
        FROM
          admin_cbt_scheduled FINAL
        WHERE
          table = 'dim_block_canonical'
      expected:
        count: 1
