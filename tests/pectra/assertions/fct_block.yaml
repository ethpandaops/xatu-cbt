- name: "Contains orphaned block"
  sql: |
    SELECT
      COUNT(*) AS count
    FROM
      fct_block FINAL
    WHERE
      status = 'orphaned'
  expected:
    count: 1
- name: "Expected bounds and size"
  sql: |
    SELECT
      COUNT(*) AS count,
      MIN(slot) AS min,
      MAX(slot) AS max
    FROM
      fct_block FINAL
  expected:
    count: 21
    min: "12145370"
    max: "12145390"
- name: "Expected admin bounds"
  sql: |
    SELECT
      fromUnixTimestamp(MAX(position + interval)) AS max,
      fromUnixTimestamp(MIN(position)) AS min
    FROM
      admin_cbt FINAL
    WHERE
      table = 'fct_block'
  expected:
    max: "2025-07-15T08:38:23Z"
    min: "2025-07-15T08:34:23Z"
