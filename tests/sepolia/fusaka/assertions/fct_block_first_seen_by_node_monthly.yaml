- name: "Expected bounds and size"
  sql: |
    SELECT
      COUNT(*) AS count,
      MIN(month_start_date_time) AS min,
      MAX(month_start_date_time) AS max
    FROM
      fct_block_first_seen_by_node_monthly FINAL
  expected:
    count: 35
    min: "2025-10-01T00:00:00Z"
    max: "2025-10-01T00:00:00Z"
- name: "Expected admin bounds"
  sql: |
    SELECT
      fromUnixTimestamp(MAX(position + interval)) AS max,
      fromUnixTimestamp(MIN(position)) AS min
    FROM
      admin_cbt_incremental FINAL
    WHERE
      table = 'fct_block_first_seen_by_node_monthly'
  expected:
    max: "2025-10-27T00:30:24Z"
    min: "2025-10-27T00:26:36Z"
