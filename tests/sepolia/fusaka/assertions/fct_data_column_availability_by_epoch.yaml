- name: Row count should be greater than zero
  sql: |
    SELECT
      COUNT(*) AS count
    FROM
      fct_data_column_availability_by_epoch FINAL
  assertions:
    - type: greater_than
      column: count
      value: 0

- name: Epoch bounds should match test data range (slots 8771000-8773000 = epochs ~274093-274156)
  sql: |
    SELECT
      MIN(epoch) AS min_epoch,
      MAX(epoch) AS max_epoch
    FROM
      fct_data_column_availability_by_epoch FINAL
  assertions:
    - type: greater_than_or_equal
      column: min_epoch
      value: 274000
    - type: less_than_or_equal
      column: max_epoch
      value: 274200

- name: Column index should be in valid range (0-127)
  sql: |
    SELECT
      MIN(column_index) AS min_col,
      MAX(column_index) AS max_col
    FROM
      fct_data_column_availability_by_epoch FINAL
  assertions:
    - type: greater_than_or_equal
      column: min_col
      value: 0
    - type: less_than_or_equal
      column: max_col
      value: 127

- name: Slot count should be reasonable (1-32 slots per epoch)
  sql: |
    SELECT
      MIN(slot_count) AS min_slots,
      MAX(slot_count) AS max_slots
    FROM
      fct_data_column_availability_by_epoch FINAL
  assertions:
    - type: greater_than
      column: min_slots
      value: 0
    - type: less_than_or_equal
      column: max_slots
      value: 32

- name: Average availability percentage should be valid (0-100)
  sql: |
    SELECT
      MIN(avg_availability_pct) AS min_pct,
      MAX(avg_availability_pct) AS max_pct
    FROM
      fct_data_column_availability_by_epoch FINAL
  assertions:
    - type: greater_than_or_equal
      column: min_pct
      value: 0
    - type: less_than_or_equal
      column: max_pct
      value: 100

- name: Total probe count should be greater than zero
  sql: |
    SELECT
      MIN(total_probe_count) AS min_probes
    FROM
      fct_data_column_availability_by_epoch FINAL
  assertions:
    - type: greater_than
      column: min_probes
      value: 0
