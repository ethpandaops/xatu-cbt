model: fct_attestation_correctness_by_validator_canonical
network: sepolia
spec: fusaka
external_data:
    beacon_api_eth_v1_events_block:
        url: https://data.ethpandaops.io/xatu-cbt/sepolia/fusaka/beacon_api_eth_v1_events_block.parquet
        network_column: meta_network_name
    beacon_api_eth_v1_events_block_gossip:
        url: https://data.ethpandaops.io/xatu-cbt/sepolia/fusaka/beacon_api_eth_v1_events_block_gossip.parquet
        network_column: meta_network_name
    beacon_api_eth_v1_proposer_duty:
        url: https://data.ethpandaops.io/xatu-cbt/sepolia/fusaka/beacon_api_eth_v1_proposer_duty.parquet
        network_column: meta_network_name
    canonical_beacon_block:
        url: https://data.ethpandaops.io/xatu-cbt/sepolia/fusaka/canonical_beacon_block.parquet
        network_column: meta_network_name
    canonical_beacon_committee:
        url: https://data.ethpandaops.io/xatu-cbt/sepolia/fusaka/canonical_beacon_committee.parquet
        network_column: meta_network_name
    canonical_beacon_elaborated_attestation:
        url: https://data.ethpandaops.io/xatu-cbt/sepolia/fusaka/canonical_beacon_elaborated_attestation.parquet
        network_column: meta_network_name
    canonical_beacon_proposer_duty:
        url: https://data.ethpandaops.io/xatu-cbt/sepolia/fusaka/canonical_beacon_proposer_duty.parquet
        network_column: meta_network_name
    libp2p_gossipsub_beacon_block:
        url: https://data.ethpandaops.io/xatu-cbt/sepolia/fusaka/libp2p_gossipsub_beacon_block.parquet
        network_column: meta_network_name
assertions:
    - name: Bounds
      sql: |
        SELECT
          MAX(slot_distance) AS slot_distance,
          MAX(inclusion_distance) AS inclusion_distance
        FROM
          fct_attestation_correctness_by_validator_canonical FINAL
      expected:
        inclusion_distance: 6
        slot_distance: 1
    - name: Expected size
      sql: |
        SELECT
          COUNT(*) AS count,
          MIN(slot) AS min,
          MAX(slot) AS max
        FROM
          fct_attestation_correctness_by_validator_canonical FINAL
      expected:
        count: 1108
        max: 8815952
        min: 8815933
    - name: Expected admin bounds
      sql: |
        SELECT
          fromUnixTimestamp(MAX(position + interval)) AS max,
          fromUnixTimestamp(MIN(position)) AS min
        FROM
          admin_cbt_incremental FINAL
        WHERE
          table = 'fct_attestation_correctness_by_validator_canonical'
      expected:
        max: "2025-10-27T00:30:24Z"
        min: "2025-10-27T00:26:36Z"
