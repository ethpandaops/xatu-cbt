model: fct_data_column_availability_by_epoch
network: sepolia
spec: fusaka
external_data:
    libp2p_gossipsub_data_column_sidecar:
        url: https://data.ethpandaops.io/xatu-cbt/sepolia/fusaka/libp2p_gossipsub_data_column_sidecar.parquet
        network_column: meta_network_name
    libp2p_rpc_data_column_custody_probe:
        url: https://data.ethpandaops.io/xatu-cbt/sepolia/fusaka/libp2p_rpc_data_column_custody_probe.parquet
        network_column: meta_network_name
assertions:
    - name: Row count should be greater than zero
      sql: |
        SELECT
          COUNT(*) AS count
        FROM
          fct_data_column_availability_by_epoch FINAL
      expected: {}
    - name: Epoch bounds should match test data range (slots 8771000-8773000 = epochs ~274093-274156)
      sql: |
        SELECT
          MIN(epoch) AS min_epoch,
          MAX(epoch) AS max_epoch
        FROM
          fct_data_column_availability_by_epoch FINAL
      expected: {}
    - name: Column index should be in valid range (0-127)
      sql: |
        SELECT
          MIN(column_index) AS min_col,
          MAX(column_index) AS max_col
        FROM
          fct_data_column_availability_by_epoch FINAL
      expected: {}
    - name: Slot count should be reasonable (1-32 slots per epoch)
      sql: |
        SELECT
          MIN(slot_count) AS min_slots,
          MAX(slot_count) AS max_slots
        FROM
          fct_data_column_availability_by_epoch FINAL
      expected: {}
    - name: Average availability percentage should be valid (0-100)
      sql: |
        SELECT
          MIN(avg_availability_pct) AS min_pct,
          MAX(avg_availability_pct) AS max_pct
        FROM
          fct_data_column_availability_by_epoch FINAL
      expected: {}
    - name: Total probe count should be greater than zero
      sql: |
        SELECT
          MIN(total_probe_count) AS min_probes
        FROM
          fct_data_column_availability_by_epoch FINAL
      expected: {}
