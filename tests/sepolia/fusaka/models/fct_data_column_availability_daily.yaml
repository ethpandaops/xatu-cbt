model: fct_data_column_availability_daily
network: sepolia
spec: fusaka
assertions:
    - name: Row count should be greater than zero
      sql: |
        SELECT
          COUNT(*) AS count
        FROM
          fct_data_column_availability_daily FINAL
      expected: {}
    - name: Column index should be in valid range (0-127)
      sql: |
        SELECT
          MIN(column_index) AS min_col,
          MAX(column_index) AS max_col
        FROM
          fct_data_column_availability_daily FINAL
      expected: {}
    - name: Hour count should be reasonable (1-24 hours per day)
      sql: |
        SELECT
          MIN(hour_count) AS min_hours,
          MAX(hour_count) AS max_hours
        FROM
          fct_data_column_availability_daily FINAL
      expected: {}
    - name: Average availability percentage should be valid (0-100)
      sql: |
        SELECT
          MIN(avg_availability_pct) AS min_pct,
          MAX(avg_availability_pct) AS max_pct
        FROM
          fct_data_column_availability_daily FINAL
      expected: {}
    - name: Total probe count should be greater than zero
      sql: |
        SELECT
          MIN(total_probe_count) AS min_probes
        FROM
          fct_data_column_availability_daily FINAL
      expected: {}
    - name: Date should be valid Date type
      sql: |
        SELECT
          COUNT(*) AS count
        FROM
          fct_data_column_availability_daily FINAL
        WHERE
          date IS NULL
      expected: {}
