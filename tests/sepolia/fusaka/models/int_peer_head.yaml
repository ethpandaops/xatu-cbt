model: int_peer_head
network: sepolia
spec: fusaka
external_data:
    libp2p_handle_status:
        url: https://data.ethpandaops.io/xatu-cbt/sepolia/fusaka/libp2p_handle_status.parquet
        network_column: meta_network_name
    libp2p_synthetic_heartbeat:
        url: https://data.ethpandaops.io/xatu-cbt/sepolia/fusaka/libp2p_synthetic_heartbeat.parquet
        network_column: meta_network_name
assertions:
    - name: Expected bounds and size
      sql: |
        SELECT
          COUNT(*) AS count,
          MIN(event_date_time) AS min,
          MAX(event_date_time) AS max
        FROM
          int_peer_head FINAL
      expected:
        count: 0
        max: null
        min: null
    - name: Expected admin bounds
      sql: |
        SELECT
          fromUnixTimestamp(MAX(position + interval)) AS max,
          fromUnixTimestamp(MIN(position)) AS min
        FROM
          admin_cbt_incremental FINAL
        WHERE
          table = 'int_peer_head'
      expected:
        max: null
        min: null
